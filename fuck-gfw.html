<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>翻墙 - Chifeng's Blog</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    

    <!-- Open Graph tags -->
        <meta property="og:site_name" content="Chifeng's Blog" />
            <meta property="og:type" content="article"/>
            <meta property="og:title" content="翻墙"/>
            <meta property="og:url" content="http://blog.chifeng.name/fuck-gfw.html"/>
            <meta property="og:description" content="第一篇技术文章就介绍这个，实在是很无奈，但是不学会翻墙实在是太多事情不能做。本文主要介绍一个简单的翻墙方式SSHTunnel+Proxy"/>
            <meta property="article:published_time" content="2014-07-07" />
                <meta property="article:section" content="Technology" />
                <meta property="article:tag" content="Technology" />
                <meta property="article:tag" content="SSHTunnel" />
                <meta property="article:tag" content="Squid" />
                <meta property="article:tag" content="Proxy" />
                <meta property="article:tag" content="Linux" />
                <meta property="article:author" content="Chifeng" />

    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://blog.chifeng.name/theme/css/bootstrap.readable.min.css" type="text/css"/>
    <link href="http://blog.chifeng.name/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://blog.chifeng.name/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="http://blog.chifeng.name/theme/css/style.css" type="text/css"/>

        <link href="http://blog.chifeng.name/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Chifeng's Blog ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://blog.chifeng.name/" class="navbar-brand">
Chifeng's Blog            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                        <li >
                            <a href="http://blog.chifeng.name/category/life.html">Life</a>
                        </li>
                        <li class="active">
                            <a href="http://blog.chifeng.name/category/technology.html">Technology</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="http://blog.chifeng.name/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<div class="container">
    <div class="row">
        <div class="col-sm-9">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://blog.chifeng.name/fuck-gfw.html"
                       rel="bookmark"
                       title="Permalink to 翻墙">
                        翻墙
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2014-07-07T00:00:00"> Mon 07 July 2014</time>
    </span>



<span class="label label-default">Tags</span>
	<a href="http://blog.chifeng.name/tag/technology.html">Technology</a>
        /
	<a href="http://blog.chifeng.name/tag/sshtunnel.html">SSHTunnel</a>
        /
	<a href="http://blog.chifeng.name/tag/squid.html">Squid</a>
        /
	<a href="http://blog.chifeng.name/tag/proxy.html">Proxy</a>
        /
	<a href="http://blog.chifeng.name/tag/linux.html">Linux</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>我曾经试过多种方式，早些年L2TP/PPTP/OpenVPN、甚至于普通的Squid Proxy都还能用，不幸的是现在都被封了。目前来看，如果你不加一层SSL的话，基本上是不可能翻出去了。
我自己正在使用的一种简单的翻墙方式，如下</p>
<h5>要求：</h5>
<ul>
<li>有一台在海外的云主机，比如：<a href="http://www.linode.com/" title="Linode">Linode</a> 、<a href="http://www.digitalocean.com/" title="DigitalOcean">DigitalOcean</a></li>
<li>了解一点Linux技术，SSH Tunnel、Squid和Firefox浏览器的代理设置</li>
</ul>
<hr />
<p><p>
然后分以下3步走，来完成翻墙工作</p>
<p>第一步，在你的VM上，设置一个Squid代理服务器
</p></p>
<pre><code>
apt-get -y install squid
</code></pre>

<h6>编辑/etc/squid3/squild.conf，内容如下</h6>
<p><pre>
<code>
acl SSL_ports port 443
acl Safe_ports port 80      # http
acl Safe_ports port 21      # ftp
acl Safe_ports port 443     # https
acl Safe_ports port 70      # gopher
acl Safe_ports port 210     # wais
acl Safe_ports port 1025-65535  # unregistered ports
acl Safe_ports port 280     # http-mgmt
acl Safe_ports port 488     # gss-http
acl Safe_ports port 591     # filemaker
acl Safe_ports port 777     # multiling http
acl CONNECT method CONNECT
http_access deny !Safe_ports
http_access deny CONNECT !SSL_ports
http_access allow localhost manager
http_access deny manager
http_access allow localhost
http_access deny all
http_port 3128
coredump_dir /var/spool/squid3
refresh_pattern ^ftp:       1440    20% 10080
refresh_pattern ^gopher:    1440    0%  1440
refresh_pattern -i (/cgi-bin/|\?) 0 0%  0
refresh_pattern (Release|Packages(.gz)*)$      0       20%     2880
refresh_pattern .       0   20% 4320
</code>
</pre></p>
<pre><code>
#service squid3 restart
</code></pre>

<h5>第二步，然后在本机创建一个脚本~/ssh_tunnel.sh，如下内容</h5>
<p><pre><code>
#!/bin/sh
ssh -NfL 3128:127.0.0.1:3128 chifeng@hostname.domain.com
#修改hostname.domain.com为你自己的域名，另外登陆这儿走public key认证
</code></pre></p>
<p>执行一下这个脚本，SSH Tunnel就建立起来了
<pre><code>
sh ~/ssh_tunnel.sh
</code></pre></p>
<h5>第三步，设置Firefox的代理为localhost:3128即可</h5>
<p>这样访问国内网站，使用Chrome/Safari，访问海外网站使用Firefox即可。根据SSH协议本身的安全性，目测这种翻墙方式很难被封掉，除非不容许SSH协议通过</p>
<p>当然还有一种更简单的方式，直接花钱购买相关的SSL VPN服务，比如： EUREKAVPT https://eurekavpt.com 一年300元的价格，物超所值!</p>
<p>BTW, 看到老黄已经在研究Proxy直接变为TCP的路由了，高端！！如果搞定，那就太方便了！</p>
            </div>
            <!-- /.entry-content -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'chifeng'; // required: replace example with your forum shortname

                    var disqus_identifier = 'fuck-gfw';
                var disqus_url = 'http://blog.chifeng.name/fuck-gfw.html';

            var disqus_config = function () {
                this.language = "zh_cn";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3 well well-sm" id="sidebar">

<aside>
    <section>
        <ul class="list-group list-group-flush">
                <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
                  <ul class="list-group" id="social">
                    <li class="list-group-item"><a href="http://twitter.com/chifeng"><i class="fa fa-twitter-square fa-lg"></i> Twitter</a></li>
                    <li class="list-group-item"><a href="http://github.com/chifeng"><i class="fa fa-github-square fa-lg"></i> Github</a></li>
                  </ul>
                </li>



                <li class="list-group-item"><a href="http://blog.chifeng.name/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                    <ul class="list-group " id="tags">
                        <li class="list-group-item tag-4">
                            <a href="http://blog.chifeng.name/tag/english.html">
                                English
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://blog.chifeng.name/tag/sshtunnel.html">
                                SSHTunnel
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://blog.chifeng.name/tag/linux.html">
                                Linux
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://blog.chifeng.name/tag/life.html">
                                Life
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://blog.chifeng.name/tag/technology.html">
                                Technology
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://blog.chifeng.name/tag/squid.html">
                                Squid
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://blog.chifeng.name/tag/proxy.html">
                                Proxy
                            </a>
                        </li>
                    </ul>
                </li>    
    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://python.org" target="_blank">
                Python
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://http://blog.getpelican.com" target="_blank">
                Pelican
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://zoomquiet.io" target="_blank">
                社区大妈
            </a>
        </li>
      </ul>
    </li>

        </ul>
    </section>

</aside>        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2014 Chifeng
            &middot; Powered by <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://python.org" target="_blank">Python</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://blog.chifeng.name/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://blog.chifeng.name/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://blog.chifeng.name/theme/js/respond.min.js"></script>

    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'chifeng'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->
    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-52310651-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->
</body>
</html>